CONNECT 'jdbc:derby:PinGen;create=true';

CONNECT 'jdbc:derby:PinGen';

//CREATE TABLE PIN (PIN BIGINT NOT NULL PRIMARY KEY, JOBID INT NOT NULL);

CREATE TABLE PIN (PIN VARCHAR(15) PRIMARY KEY, JOBID INT);



//status: I = initial, P = processing, S = success, F = fail
//CREATE TABLE JOB (JOBID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
//PINDIGIT INT, PINAMOUNT BIGINT, STATUS VARCHAR(1), CREATOR INT NOT NULL, CREATEDDATE TIMESTAMP NOT NULL,
//CONSTRAINT primary_key PRIMARY KEY (JOBID));

CREATE TABLE JOB (JOBID INTEGER NOT NULL PRIMARY KEY, PINDIGIT INT, PINAMOUNT BIGINT, STATUS VARCHAR(5), CREATOR INT NOT NULL, CREATEDDATE TIMESTAMP NOT NULL);

INSERT INTO JOB VALUES (0, 0, 0, 'S', 1, CURRENT_TIMESTAMP);



CREATE TABLE USR (USERID INT NOT NULL PRIMARY KEY, NAME VARCHAR(80), USERNAME VARCHAR(40), PASSWORD VARCHAR(40), CREATOR INT NOT NULL, CREATEDDATE TIMESTAMP NOT NULL);

CREATE TABLE LOG (LOGID INT NOT NULL PRIMARY KEY, LOGTYPE VARCHAR(10), LOGDESC VARCHAR(255), CREATOR INT NOT NULL, CREATEDDATE TIMESTAMP);

INSERT INTO USR VALUES (1, 'Administrator', 'ADMIN', 'admin', 1, CURRENT_TIMESTAMP); 

INSERT INTO USR VALUES (2, 'แอดมิน', 'admin', 'admin', 1, CURRENT_TIMESTAMP);

SELECT pin, COUNT(*) FROM PIN GROUP BY pin HAVING COUNT(*) > 1;

















